<messaging:emailTemplate subject="Test ICS file" recipientType="Contact" relatedToType="CC_QAppt__Appointment__c">
<messaging:plainTextEmailBody >
Congratulations!
This is your new Visualforce Email Template.
</messaging:plainTextEmailBody>

<messaging:attachment filename="{!relatedTo.Name}.ics" renderAs="text/calendar">
BEGIN:VCALENDAR
PRODID:-//GourmetPortal//NONSGML rr//DE
VERSION:2.0
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
DTSTART;TZID=GMT:<apex:outputText value="{!SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TEXT(relatedTo.Start_Date_Time__c),':',''),'-',''),' ','T')}"/>
DTEND;TZID=GMT:<apex:outputText value="{!SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TEXT(relatedTo.End_Date_Time__c),':',''),'-',''),' ','T')}"/>
DTSTAMP;TZID=GMT:<apex:outputText value="{!SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TEXT(NOW()),':',''),'-',''),' ','T')}"/>
ORGANIZER;CN=test@futureassist.com.au:mailto:test@futureassist.com.au
ATTENDEE;CUTYPE=INDIVIDUAL;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;X-NUM-GUESTS=0:mailto:"/>
UID:<apex:outputText value="{!relatedTo.id}"/>
CREATED;TZID=GMT:<apex:outputText value="{!SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TEXT(NOW()),':',''),'-',''),' ','T')}"/>
DESCRIPTION:<apex:outputText value="Please contact your adviser if you need to reschedule the time of this appointment" escape="false"/>
LAST-MODIFIED;TZID=GMT:<apex:outputText value="{!SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TEXT(NOW()),':',''),'-',''),' ','T')}"/>
LOCATION:
SEQUENCE:0
STATUS:CONFIRMED
SUMMARY:<apex:outputText value="{!relatedTo.Name}"/>
TRANSP:OPAQUE
BEGIN:VALARM
ACTION:DISPLAY
DESCRIPTION:This is an event reminder
TRIGGER:-P0DT0H30M0S
END:VALARM
END:VEVENT
END:VCALENDAR
</messaging:attachment>

</messaging:emailTemplate>