<apex:page controller="FeedbackFormController" standardStylesheets="false" doctype="html-5.0">
    <apex:slds />
    <apex:stylesheet value="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <style type="text/css">
        /* Rating Star Widgets Style */
        .rating-stars ul {
            list-style-type:none;
            padding:0;
            
            -moz-user-select:none;
            -webkit-user-select:none;
        }
    .rating-stars ul > li.star {
        display:inline-block;
        
    }
    
    /* Idle State of the stars */
    .rating-stars ul > li.star > i.fa {
        font-size:2.5em; /* Change the size of the stars */
        color:#ccc; /* Color on idle state */
    }
    
    /* Hover state of the stars */
    .rating-stars ul > li.star.hover > i.fa {
        color:#FFCC36;
    }
    
    /* Selected state of the stars */
    .rating-stars ul > li.star.selected > i.fa {
        color:#FF912C;
    }
    </style>
    
    <head>
        <script>
        $(document).ready(function(){
        
        /* 1. Visualizing things on Hover - See next part for action on click */
        $('#stars li').on('mouseover', function(){
            
            var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on
            
            // Now highlight all the stars that's not after the current hovered star
            $(this).parent().children('li.star').each(function(e){
                if (e < onStar) {
                    $(this).addClass('hover');
                }
                else {
                    $(this).removeClass('hover');
                }
            });
            
        }).on('mouseout', function(){
            $(this).parent().children('li.star').each(function(e){
                $(this).removeClass('hover');
            });
        });
        
        
        /* 2. Action to perform on click */
        $('#stars li').on('click', function(){
            var onStar = parseInt($(this).data('value'), 10); // The star currently selected
            var stars = $(this).parent().children('li.star');
            
            for (i = 0; i < stars.length; i++) {
                $(stars[i]).removeClass('selected');
            }
            
            for (i = 0; i < onStar; i++) {
                $(stars[i]).addClass('selected');
            }
            
            // JUST RESPONSE (Not needed)
            var ratingValue = parseInt($('#stars li.selected').last().data('value'), 10);
            getRatingValue(ratingValue);
            var msg = "";
            if (ratingValue > 1) {
                msg = "Thanks! You rated this " + ratingValue + " stars.";
            }
            else {
                msg = "We will improve ourselves. You rated this " + ratingValue + " stars.";
            }
            
            
        });
        
        
    });
    
    function getRatingValue(data) {
      passToController(data);
    }
    
    </script>
</head>
<apex:form id="frm">
    
   <apex:actionFunction action="{!saveFeedback}" name="passToController" rerender="false">
<apex:param value="" assignto="{!ratingNumber}" name="inpval"/>
</apex:actionFunction>
    
    <div class="slds-panel slds-size_medium slds-panel_docked slds-panel_docked-left slds-is-open slds-align_absolute-center slds-m-top_x-large" style="width: 40%; background:#ecebea;" aria-hidden="false">
        <div class="slds-panel__header">
            <h2 class="slds-panel__header-title slds-text-heading_small slds-truncate slds-align_absolute-center" title="Panel Header">Quick Appointment Feedback</h2>
        </div>
        <div class="slds-panel__body">
            <div class="slds-grid slds-grid_vertical">
                <div class="slds-col slds-border_bottom">
                    <span>We would like your feedback to improve our app.<br/>
                        What is your opinion of this app?
                        
                        <section class='rating-widget slds-align_absolute-center slds-m-top_small slds-m-bottom_x-small'>
                            <!-- Rating Stars Box -->
                            <div class='rating-stars text-center'>
                                <ul id='stars'>
                                    <li class='star' title='Poor' data-value='1'>
                                        <i class='fa fa-star fa-fw'></i>
                                    </li>
                                    <li class='star' title='Fair' data-value='2'>
                                        <i class='fa fa-star fa-fw'></i>
                                    </li>
                                    <li class='star' title='Good' data-value='3'>
                                        <i class='fa fa-star fa-fw'></i>
                                    </li>
                                    <li class='star' title='Excellent' data-value='4'>
                                        <i class='fa fa-star fa-fw'></i>
                                    </li>
                                    <li class='star' title='WOW!!!' data-value='5'>
                                        <i class='fa fa-star fa-fw'></i>
                                    </li>
                                </ul>
                            </div></section>                    </span>
                </div>
                <div class = "slds-col slds-border_bottom slds-p-vertical_medium">
                    
                    <span class="slds-m-top_small">Please select your feedback category below.</span>
                    
                    <div class="slds-grid slds-gutters">
                        
                        <apex:repeat value="{!pickListValuesList}" var="pickValue" id="theRepeat">
                            <div class="slds-col ">
                                <div class="slds-box slds-m-top_x-small">
                                    <p>{!pickValue}</p>
                                </div>
                            </div>
                        </apex:repeat>
                        
                        
                    </div>
                </div>
                <div class="slds-col slds-p-vertical_medium">
                    <p>Please leave your feedback below:</p>
                    <div class="slds-m-top_x-small">
                        
                        <apex:inputTextarea id="newDesc" value="{!qaf.name}" style="width: 100%;height:72px;"/><p/>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
    <button class="slds-button slds-button_brand slds-align_absolute-center slds-m-top_small" onclick="passToController(); return false;">Submit</button>
   
</apex:form>
</apex:page>